import pyfits,numpy
import numpy
import os,sys,math,shutil

#ra,dec, UltraVista 8,masked in obtical (0) 12, Cosmos area 13, Ks_mag_aper2 21,Ks_err2 22, Ks_mag_aper2 23, ks_mag_err 24, ks_Flags 28, Y_mag_ap2 34, Y_mager_ap2 35, Y_mag_ap3 36, Y_mager_ap3 37, Y_flag 42, H_mag_ap2 48, H_mager_ap2 49, H_mag_ap3 50, H_mager_ap3 51, H_flag 56, J_mag_ap2 62, J_mager_ap2 63, J_mag_ap3 64, J_mag_ap3 65, J_flag 70,B_mag_ap2 76, B_mager_ap2 77, B_mag_ap3 78, B_mag_ap3 79, B_flag 84, V_mag_ap2 90, V_mager_ap2 91, V_mag_ap3 92, V_mag_ap3 93, V_flag 98, r_mag_ap2 118, r_mager_ap2 119, r_mag_ap3 120, r_mag_ap3 121, r_flag 126, u_mag_ap2 132, u_mager_ap2 133, u_mag_ap3 134, u_mag_ap3 135, u_flag 140, NUV_mag_ap2 446, NUV_mager 447, VLA_90cm_name 456, VLA_90cm_peak 457, VLA_90cm_peaker 458, VLA_90cm_int 459, VLA_90cm_inter 460, VLA_90cm_rms 461, JVLA_D_name 462, JVLA_L_name, 463, VLA_20cm_peak 464, VLA_20cm_peaker 465, VLA_20cm_int 466, VLA_20cm_inter 467, VLA_20cm_rms 468, photoz,photoz_h, photoz_l, photoz_chi starforming 520 
    
fit = '/home/eliab/Documents/OC/Project/cosmos/COSMOS2015_v1.1.fits'
array , hdr = pyfits.getdata(fit,header=1)

aray=numpy.array(array)
f = open('/home/eliab/Documents/OC/Project/cosmos/cosmos_2015.el', 'w')

f.write('# %15s %15s %6s %6s %10s %6s %6s   %6s %6s %6s %6s %6s   %6s %6s %6s %6s %6s    %6s %6s %6s %6s %6s   %6s %6s %6s %6s %6s   %6s %6s %6s %6s %6s   %6s %6s %6s %6s %6s        %6s %6s %6s %6s %6s    %6s %6s %6s %6s %6s   %6s %6s %6s %6s %6s    %6s %6s %6s  %6s %6s %6s      %6s %6s %6s %6s     %6s %6s %6s %6s %6s \n' %('Ra','Dec', 'UltraVista' ,'OptMask','ID', 'Ks_mag_aper2', 'Ks_err2', 'Ks_mag_aper3' , 'ks_mag_err3', 'ks_Flags', 'Y_mag_ap2' , 'Y_mager_ap2', 'Y_mag_ap3', 'Y_mager_ap3', 'Y_flag', 'H_mag_ap2', 'H_mager_ap2', 'H_mag_ap3', 'H_mager_ap3', 'H_flag', 'J_mag_ap2 ', 'J_mager_ap2', 'J_mag_ap3', 'J_mag_ap3', 'J_flag' ,'B_mag_ap2', 'B_mager_ap2' , 'B_mag_ap3', 'B_mag_ap3' , 'B_flag' , 'V_mag_ap2', 'V_mager_ap2' , 'V_mag_ap3', 'V_mag_ap3' , 'V_flag' , 'r_mag_ap2' , 'r_mager_ap2', 'r_mag_ap3', 'r_mag_ap3', 'r_flag', 'u_mag_ap2', 'u_mager_ap2', 'u_mag_ap3', 'u_mag_ap3', 'u_flag', 'NUV_mag_ap2' , 'VLA_20cm_inter', 'VLA_20cm_rms',   'z_ph', 'type','z_ph_h','z_ph_l','z_ph_chi','z_ph_2','z_ph_2_chi','MNUV','Mr','MJ','MNUv-Mr','Mass_med', 'Mass_med_min68', 'Mass_med_max68', 'Mass_best','SF_med', 'SF_med_min68', 'SF_med_max68', 'SF_best'  
 ))

count=0

for gal in aray:
  f.write('%15.10f %15.10f  %6.2f %6.2f %10d %5.3f  %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f  %6.4f %6.4f   %6.2f %6.4f %6.4f %6.4f %6.4f    %6.4f %6.4f %6.4f     %6.2f %6.4f %6.4f %6.4f   %6.2f %6.2f %6.4f %6.4f %6.4f \n' %(gal[0], gal[1],   gal[8], gal[12],gal[2], gal[20], gal[21], gal[22], gal[23], gal[28],   gal[34], gal[35], gal[36], gal[37], gal[42],  gal[48], gal[49], gal[50], gal[51], gal[56],  gal[62], gal[63], gal[64], gal[65], gal[70],  gal[76], gal[77], gal[78], gal[79], gal[84],    gal[90],  gal[91],  gal[92],  gal[93],  gal[98],    gal[118], gal[119], gal[120], gal[121], gal[126],    gal[132], gal[133], gal[134], gal[135], gal[140],    gal[446], gal[447],   gal[491], gal[492],gal[494], gal[493], gal[496], gal[497], gal[498],     gal[508], gal[512], gal[517], gal[520],   gal[521], gal[522], gal[523], gal[524],    gal[525], gal[526], gal[527], gal[528]))
  count+=1
  if count%1e4==0:print count
  
print 'done' 
f.close()
#for i in range(len(ra)):                                                                                                                                                                                      f.write('%15.10f %15.10f  %6.2f %6.2f %5.3f  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f   %10s %6.4e %6.4e %6.4e %6.4e %6.4e   %10s %10s   %6.4e %6.4e %6.4e %6.4e %6.4e  %6.4f %6.4f  %6.4f %6.4f %6.4f %6.4f  %2f \n'%(ra[i],dec[i],id[i],ultraV[i],peter[i],ks[i],kser[i],ks_2[i],kser_2[i],ks_f[i],y[i],yer[i],y_2[i],yer_2[i],y_f[i],h[i],her[i],h_2[i],her_2[i],h_f[i],j[i],jer[i],j_2[i],jer_2[i],j_f[i],b[i],ber[i],b_2[i],ber_2[i],b_f[i],v[i],ver[i],v_2[i],ver_2[i],v_f[i],u[i],uer[i],u_2[i],uer2[i],u_f[i],r[i],rer[i],r_2[i],rer_2[i],r_f[i],nuv[i],nuver[i],   v_90_n[i],v_90_p[i],v_90_per[i],v_90_i[i],v_90_ier[i],v_90_rms[i],  jv_d_n[i], jv_l_n[i],  v_20_p[i],v_20_per[i],v_20_i[i],v_20_ier[i],v_20_rms[i],  z[i],z_u[i],z_l[i],z_chi[i],z_2[i],Z_2_chi[i], sf[i]))
#for i in range(len(ra)):                                                                                                                                                                                      f.write('%15.10f %15.10f  %6.2f %6.2f %5.3f  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f %6.2f %6.2f %2d  %6.2f %6.2f %6.2f %6.2f %2d   %6.2f %6.2f   %10s %6.4e %6.4e %6.4e %6.4e %6.4e   %10s %10s   %6.4e %6.4e %6.4e %6.4e %6.4e  %6.4f %6.4f  %6.4f %6.4f %6.4f %6.4f  %2f \n'%(ra[i],dec[i],id[i],ultraV[i],peter[i],ks[i],kser[i],ks_2[i],kser_2[i],ks_f[i],y[i],yer[i],y_2[i],yer_2[i],y_f[i],h[i],her[i],h_2[i],her_2[i],h_f[i],j[i],jer[i],j_2[i],jer_2[i],j_f[i],b[i],ber[i],b_2[i],ber_2[i],b_f[i],v[i],ver[i],v_2[i],ver_2[i],v_f[i],u[i],uer[i],u_2[i],uer2[i],u_f[i],r[i],rer[i],r_2[i],rer_2[i],r_f[i],nuv[i],nuver[i],   v_90_n[i],v_90_p[i],v_90_per[i],v_90_i[i],v_90_ier[i],v_90_rms[i],  jv_d_n[i], jv_l_n[i],  v_20_p[i],v_20_per[i],v_20_i[i],v_20_ier[i],v_20_rms[i],  z[i],z_u[i],z_l[i],z_chi[i],z_2[i],Z_2_chi[i], sf[i]))

